<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description"
    content="Contact Abdul Hadi for collaborations, services, or inquiries. Get in touch via email or the contact form." />
  <meta name="keywords" content="Contact Abdul Hadi, Hire Cybersecurity Expert, AI Developer" />
  <title>Contact Me | Abdul Hadi</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
</head>

<body>
  <header class="header"></header>

  <main>
    <section class="contact">
      <div class="container">
        <h1 class="section-title">Contact Me</h1>
        <p class="section-subtitle">
          Have a question or want to work together? Feel free to reach out. I'd love to hear from you!
        </p>

        <div class="contact-container">
          <div class="contact-info">
            <div class="contact-info-item">
              <div class="icon"><i class="fas fa-envelope"></i></div>
              <div>
                <h4>Email</h4>
                <p>abdul@abdulhadi.com.np</p>
              </div>
            </div>

            <div class="contact-info-item">
              <div class="icon"><i class="fab fa-linkedin"></i></div>
              <div>
                <h4>LinkedIn</h4>
                <p>linkedin.com/in/abdulhadi-cyberai</p>
              </div>
            </div>

            <div class="contact-info-item">
              <div class="icon"><i class="fas fa-map-marker-alt"></i></div>
              <div>
                <h4>Location</h4>
                <p>Kathmandu, Bagmati, Nepal</p>
              </div>
            </div>
          </div>

          <div class="contact-form">
            <!-- MESSAGE FOR NON-LOGGED-IN USERS -->
            <div id="loginMessage" style="display:none; text-align:center; color:#ff5555; margin-bottom:15px;">
              Please <a href="auth.html" style="color:#007BFF;">sign in</a> or <a href="auth.html"
                style="color:#007BFF;">sign up</a> to send a message.
            </div>

            <!-- CONTACT FORM (hidden for guests) -->
            <form id="contactForm" action="https://formspree.io/f/xanpjrvg" method="POST" style="display:none;">
              <div class="form-group">
                <label>Your Name</label>
                <input type="text" name="name" id="contactName" placeholder="Enter your name" required readonly />
              </div>

              <div class="form-group">
                <label>Your Email</label>
                <input type="email" name="email" id="contactEmail" placeholder="Enter your email" required readonly />
              </div>

              <div class="form-group">
                <label>Your Message</label>
                <textarea name="message" id="contactMessage" placeholder="Write your message" required></textarea>
              </div>

              <button type="submit" class="btn btn-primary">Send Message</button>
            </form>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer"></footer>

  <script src="script.js"></script>

  <!-- Contact Page Login Check -->
<script>
document.addEventListener("DOMContentLoaded", () => {
    const email = localStorage.getItem("site_user_email");
    const form = document.getElementById("contactForm");
    const loginMsg = document.getElementById("loginMessage");
    const emailInput = document.getElementById("contactEmail");
    const nameInput = document.getElementById("contactName");

    // Create limit message and timer container
    const limitContainer = document.createElement("div");
    limitContainer.id = "limitContainer";
    limitContainer.style.textAlign = "center";
    limitContainer.style.marginTop = "20px";
    limitContainer.style.display = "none";
    limitContainer.style.fontSize = "1.1em";
    limitContainer.style.color = "#ff4444";
    form.parentElement.appendChild(limitContainer);

    // Helper: Format time
    function formatTime(ms) {
        const totalSeconds = Math.floor(ms / 1000);
        const hours = Math.floor(totalSeconds / 3600);
        const minutes = Math.floor((totalSeconds % 3600) / 60);
        const seconds = totalSeconds % 60;
        return `${hours.toString().padStart(2,"0")}:${minutes.toString().padStart(2,"0")}:${seconds.toString().padStart(2,"0")}`;
    }

    // Update timer display with clickable urgent email
    function updateTimer(remainingMs) {
        limitContainer.innerHTML = `
            <p>You’ve already sent a message today.</p>
            <p>Please wait <strong>${formatTime(remainingMs)}</strong> to send another.</p>
            <p>If urgent, contact me directly: 
                <span id="urgent-email" style="color:#007bff; text-decoration:underline; cursor:pointer;">abdul@abdulhadi.com.np</span>
            </p>
            <p style="font-size:0.9em; color:#888;">If clicking the email doesn’t work, copy and paste it into your mail client to send a message.</p>
        `;
        const urgentLink = document.getElementById('urgent-email');
        if (urgentLink) {
            urgentLink.addEventListener('click', function() {
                window.location.href = "mailto:abdul@abdulhadi.com.np";
            });
        }
    }

    // Start countdown timer
    function startCountdown(remainingMs, lastSentKey) {
        form.style.display = "none";
        limitContainer.style.display = "block";
        updateTimer(remainingMs);

        const interval = setInterval(() => {
            const lastSentTime = parseInt(localStorage.getItem(lastSentKey));
            const now = Date.now();
            const remaining = 86400000 - (now - lastSentTime);

            if (remaining <= 0) {
                clearInterval(interval);
                localStorage.removeItem(lastSentKey);
                limitContainer.style.display = "none";
                form.style.display = "block";
                return;
            }
            updateTimer(remaining);
        }, 1000);
    }

    // Main logic
    if (email) {
        loginMsg.style.display = "none";
        form.style.display = "block";

        // Unlock name (editable)
        nameInput.removeAttribute("readonly");
        nameInput.style.backgroundColor = "";
        nameInput.style.cursor = "";

        // Lock email (visible only)
        emailInput.value = email;
        emailInput.readOnly = true;
        emailInput.style.backgroundColor = '#f5f5f5';
        emailInput.title = "You cannot change this email";
        emailInput.style.cursor = "not-allowed";
        emailInput.addEventListener('click', () => {
            alert("You cannot change your email here.");
        });

        const lastSentKey = `lastContactTime_${email}`;
        const lastSentTime = localStorage.getItem(lastSentKey);
        const now = Date.now();

        // If still in cooldown → show timer immediately
        if (lastSentTime && now - parseInt(lastSentTime) < 86400000) {
            const remaining = 86400000 - (now - parseInt(lastSentTime));
            startCountdown(remaining, lastSentKey);
        }

        // Handle submit
        form.addEventListener("submit", (e) => {
            e.preventDefault();
            const lastSentTime = localStorage.getItem(lastSentKey);
            const now = Date.now();

            if (lastSentTime && now - parseInt(lastSentTime) < 86400000) {
                const remaining = 86400000 - (now - parseInt(lastSentTime));
                startCountdown(remaining, lastSentKey);
                return;
            }

            // Store timestamp and start cooldown
            localStorage.setItem(lastSentKey, now);
            form.reset();
            alert("Message sent successfully!");
            startCountdown(86400000, lastSentKey);
        });

    } else {
        // Not logged in → hide form, show login message
        form.style.display = "none";
        loginMsg.style.display = "block";
    }
});
</script>


</body>

</html>
